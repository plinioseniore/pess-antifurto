<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Pess iBoxer - Analisi di Sicurezza by plinioseniore</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Pess iBoxer - Analisi di Sicurezza</h1>
      <h2 class="project-tagline">La sicurezza informatica dell&#39;antifurto iBoxer</h2>
      <a href="https://github.com/plinioseniore/pess-antifurto" class="btn">View on GitHub</a>
      <a href="https://github.com/plinioseniore/pess-antifurto/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/plinioseniore/pess-antifurto/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="antifurto-pess-iboxer---sicurezza-informatica" class="anchor" href="#antifurto-pess-iboxer---sicurezza-informatica" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Antifurto Pess iBoxer - Sicurezza Informatica</h1>

<h2>
<a id="in-breve" class="anchor" href="#in-breve" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>In breve</h2>

<p>Ho passato qualche ora a giocare con la sicurezza informatica del nuovo antifurto installato in casa, i-Boxer prodotto da Pess Technology, questo repository contiene le catture dati con le interazioni tra antifurto e applicazione utente, mostrando come si possano recuperare le credenziali di accesso.</p>

<blockquote>
<p>Le informazioni fornite di seguito hanno un puro scopo indicativo con l'obiettivo di sensibilizzare l'importanza della sicurezza informatica dei prodotti connessi ad Internet.</p>
</blockquote>

<p><em>Il file di cattura è stato modificato per nascondere le informazioni sensibili, come la password.</em></p>

<h3>
<a id="il-modulo-digi-connect-me" class="anchor" href="#il-modulo-digi-connect-me" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Il modulo Digi Connect ME</h3>

<p>La centralina utilizza un protocollo binario bidirezionale basato su RS232 ed un modulo Digi Connect ME per incapsulare il protocollo RS232 su una socket TCP.</p>

<p><img src="https://raw.githubusercontent.com/plinioseniore/pess-antifurto/master/images/digi-connect-me.jpg" alt=""></p>

<p>Le credenziali di accesso al modulo erano quelle di default, utilizzando <strong>root</strong> e <strong>dbps</strong> si può accedere al pannello di configurazione del modulo Digi Connect ME</p>

<p><img src="https://raw.githubusercontent.com/plinioseniore/pess-antifurto/master/images/digi-http.png" alt=""></p>

<p>Il modulo apre una connessione verso <em>pesscloud.com</em> all'indirizzo 51.255.163.83, se questa connessione non è attiva si mette in ascolto sulla porta 2101. Questi dati sono in genere disponibili anche sul manuale utente e non è strettamente necessario accedere al modulo Digi Connect ME.</p>

<h3>
<a id="password-gestite-in-chiaro" class="anchor" href="#password-gestite-in-chiaro" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Password gestite in chiaro</h3>

<p>Con un semplice <em>Men in The Middle</em> è possibile recuperare l'intera sessione di comunicazione tra l'applicazione e la centralina, in cui c'è evidenza della password in chiaro (nel rettangolo rosso).</p>

<p><img src="https://raw.githubusercontent.com/plinioseniore/pess-antifurto/master/images/TCPstream_locale.png" alt=""></p>

<p>Non c'è un meccanismo in due passaggi che permetterebbe di trasmettere i dati in chiaro senza poter essere riutilizzati, quindi basta intercettare il traffico e riprodurre la sequenza di scambio per accedere alla centralina.</p>

<p>Nel rettangolo blu alla riga 0x0EC è indicato se l'allarme è disattivato (0x00) o attivato (valore diverso da 0x00) e nel rettangolo viola se ci sono finestre aperte (0x00 per finestre chiuse). Nel caso dell'esempio l'antifurto era disattivato e le finestre aperte.</p>

<h3>
<a id="il-sistema-cloud" class="anchor" href="#il-sistema-cloud" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Il sistema cloud</h3>

<p>Il server <em>pesscloud.com</em> di fatto rigira solo il flusso dati dalla porta RS232 della centralina verso il cellullare connesso anche se fuori dalla rete locale, qualsiasi interazione fatta in locale può essere effettuata in remoto. Anche in questo caso, con un <em>Men in The Middle</em> è possibile recuperare tutti i dati di accesso, per poter poi accedere al sistema antifurto da remoto.</p>

<p><img src="https://raw.githubusercontent.com/plinioseniore/pess-antifurto/master/images/HTTPsteam_cloud.png" alt="">
<img src="https://raw.githubusercontent.com/plinioseniore/pess-antifurto/master/images/TCPstream_cloud.png" alt=""></p>

<h2>
<a id="un-potenziale-attacco-automatizzato" class="anchor" href="#un-potenziale-attacco-automatizzato" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Un potenziale attacco automatizzato</h2>

<p>Come prerequisito la rete locale su cui è stato installato l'antifurto deve esser stata violata o in altenativa un PC sulla stessa rete deve esser stato violato, in questo modo è possibile effettuare un furto dei dati di accesso con i seguenti passi:</p>

<ol>
<li>Identificare l'eventuale presenza di un antifurto Pess i-Boxer</li>
<li>Effettuare un MITM</li>
<li>Attendere un accesso da parte del proprietario del sistema</li>
</ol>

<h3>
<a id="identificare-leventuale-presenza-di-un-antifurto-pess-i-boxer" class="anchor" href="#identificare-leventuale-presenza-di-un-antifurto-pess-i-boxer" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Identificare l'eventuale presenza di un antifurto Pess i-Boxer</h3>

<p>L'individuazione è semplice, ed è composta dai seguenti passi</p>

<ol>
<li>Effettuare uno scan dei dispositivi collegati sulla rete, individuando i MAC address della Digiboard (00:40:9D:xx:xx:xx)</li>
<li>Dirottare il traffico del dispositivo Digiboard per analizzarlo (MITM)</li>
<li>Verificare se c'è traffico dati verso l'indirizzo IP del server <em>pesscloud.com</em>
</li>
</ol>

<p>Se il punto 3 è verificato, si tratta di un antifurto Pess connesso al cloud. Se non viene riscontrata una connessione verso <em>pesscould.com</em> si può effettuare uno scan delle porte TCP aperte sul dispositivo, con particolare enfasi su 2101 ed inviare la sequenza esadecimale </p>

<p><code>FF 02 01 00 00 00 00 00 01 FF 03</code></p>

<p>Se la risposta conterrà <code>FF 02 81 41 00 C2 FF 03</code> , il punto 3 è verificato. Queste stringhe non sembrano essere legate al numero di serie della centralina. </p>

<p>A questo punto non resta che attendere una connessione valida, in modo che saranno disponibili tutte le credenziali di accesso. Di conseguenza sarà possibile monitorare lo stato dell'antifurto, disattivarlo da remoto e forzarne le uscite (ad esempio facendo suonare le sirene anche in assenza di una reale intrusione).</p>

<h2>
<a id="possibili-utilizzi-e-rischi-per-lutente" class="anchor" href="#possibili-utilizzi-e-rischi-per-lutente" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Possibili utilizzi e rischi per l'utente</h2>

<p>Nella pratica, probabilmente il rischio principale non è per l'utente ma per l'azienda produttrice. Violare il sistema Pess i-Boxer richiede conoscenze informatiche nella media, ma non è possibile con la sola violazione della centralina individuare l'indirizzo d'installazione.</p>

<p>E' invece tutto sommato semplice poter realizzare dei malware che forzino comportamenti inattesi, come l'attivazione o la disattivazione dell'antifurto o l'attivazione delle sirene senza motivo apparente, questo minerebbe la credibilità dell'utenza verso il sistema di antifurto.</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/plinioseniore/pess-antifurto">Pess iBoxer - Analisi di Sicurezza</a> is maintained by <a href="https://github.com/plinioseniore">plinioseniore</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
